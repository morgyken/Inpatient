$(function(){function e(){$("#show_consumable_selection").hide(),$("#consumableInfo > tbody > tr").remove();var e=0;$("#consumable_form").find("input:checkbox:checked").each(function(){var a=$(this).val(),t=$("#consumable_form").find("#name"+a).html(),o=n(a);e+=parseInt(o),$("#consumableInfo > tbody").append("<tr><td>"+t+"</td><td>"+o+"</td></tr>")}),e&&$("#consumableInfo > tbody").append("<tr><td>Total</td><td><strong>"+e+"</strong></td></tr>"),$("#show_consumable_selection").show()}function n(e){var n=$("#consumable_form"),a=n.find("#cost"+e).val(),t=n.find("#discount"+e).val(),o=function(e,n,a){try{var t=e*n;return t-t*(a/100)}catch(n){return e}}(a,n.find("#quantity"+e).val(),t);return n.find("#amount"+e).val(o),o}$(".instructions").hide(),$("#consumable_forminput,#consumable_formtextarea,#nurse_form input,#nurse_form textarea").blur(function(){e()}),$("#in_consumables_table").dataTable({ajax:THE_CONSUMABLE_URL,responsive:!0}),$("#consumable_form").find("input:text").keyup(function(){e()}),$("input").on("ifChanged",function(){var n=$(this).parents("tr").find("input"),a=$(this).parents("tr").find("textarea");$(this).is(":checked")?(n.prop("disabled",!1),a.prop("disabled",!1),$(a).parent().show()):(n.prop("disabled",!0),a.prop("disabled",!0),$(a).parent().hide()),$(this).prop("disabled",!1),e()}),$("#consumable_form.check").click(function(){var n=$(this).parent().parent().find("input"),a=$(this).parent().parent().find("textarea");$(this).is(":checked")?(n.prop("disabled",!1),a.prop("disabled",!1),$(a).parent().show()):(n.prop("disabled",!0),a.prop("disabled",!0),$(a).parent().hide()),$(this).prop("disabled",!1),e()}),$("#saveConsumable").click(function(e){e.preventDefault(),$.ajax({type:"POST",url:DIAGNOSIS_URL,data:$("#doctor_form, #nurse_form").serialize(),success:function(){alertify.success('<i class="fa fa-check-circle"></i> Patient consumable updated'),$("#consumableTab").find("input").iCheck("uncheck"),$("#in_consumables_table").dataTable().api().ajax.reload()},error:function(){alertify.error('<i class="fa fa-check-warning"></i> Could not save consumable')}})}),$("#consumable_form").find("input:radio, input:checkbox").prop("checked",!1),$("#show_consumable_selection").hide()});